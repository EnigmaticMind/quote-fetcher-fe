import{R as y,a as i,p as e,v as L,w as $}from"./chunk-PVWAREVJ-BzOmas8B.js";const Q=y.memo(function({}){return i.useEffect(()=>{console.log("Rendering Action Panel")}),e.jsxs("div",{className:"w-64 bg-card border border-border rounded-lg p-4",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-card-foreground",children:"Actions"}),e.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-card-foreground",children:"Arrow Keys:"})," ","focus cells"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-card-foreground",children:"X Key:"})," ","select cells"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-card-foreground",children:"Shift + Arrow Keys:"})," ","Bulk select cells"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-card-foreground",children:"Space:"})," ","scrape quote using Puppeteer"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-card-foreground",children:"Esc:"})," clear selected cells"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-card-foreground",children:"Ctrl + A:"})," ","select all cells"]}),e.jsx("div",{className:"mt-3 pt-2 border-t border-border",children:e.jsxs("p",{className:"text-xs",children:[e.jsx("span",{className:"font-medium text-card-foreground",children:"Note:"})," Each fetch uses Puppeteer to scrape live quotes from quotes.toscrape.com. The browser launches, navigates, and extracts real data!"]})})]})]})}),q=y.memo(function({index:o,isFocused:g,isSelected:j,isLoading:r,loadingMessage:p,content:x}){i.useEffect(()=>{console.log(`Render Quote Cell ${o}`),console.log(`Content: ${x}`)});const f=m=>{const c=m.text.split(" ");return`${c.slice(0,Math.min(5,Math.max(3,c.length))).join(" ")}..."`};return e.jsx("div",{className:`w-52 h-16 bg-card border border-border rounded-lg flex items-center justify-center text-card-foreground font-medium transition-colors ${g?"ring-2 ring-primary bg-accent text-accent-foreground":""} ${j?"bg-primary text-primary-foreground":""}`,children:r?e.jsx("span",{className:"text-sm text-muted-foreground animate-pulse",children:p||"Loading..."}):x?e.jsx("span",{className:"italic text-sm px-2 text-center",children:f(x)}):"Empty"})}),T=y.memo(function({cellContent:o}){var g;return i.useEffect(()=>{console.log("Rendering Quote Details"),console.log(o)}),e.jsxs("div",{className:"w-64 bg-white border border-border rounded-lg p-4 flex-shrink-0 self-start",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Details"}),o&&e.jsx("svg",{className:"w-4 h-4 text-muted-foreground hover:text-foreground cursor-pointer transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),o?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-foreground mb-2",children:"Full Quote:"}),e.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:o==null?void 0:o.text})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-foreground mb-1",children:"Author:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:o==null?void 0:o.author})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-foreground mb-1",children:"Tags:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:(g=o==null?void 0:o.tags)==null?void 0:g.map((j,r)=>e.jsx("span",{className:"px-2 py-1 bg-muted text-muted-foreground text-xs rounded-md",children:j},r))})]})]}):e.jsx("p",{className:"text-muted-foreground text-sm",children:o!==null?"Cell is empty":"Press space to activate keyboard navigation"})]})}),F=({message:h,onClose:o})=>(i.useEffect(()=>{const g=setTimeout(o,3e3);return()=>clearTimeout(g)},[o]),e.jsx("div",{className:"fixed top-5 right-5 bg-red-600 text-white px-4 py-2 rounded-lg shadow-lg animate-fade-in",children:h})),S=new Map,K=10,W=10;function B(){const[h]=L(),o=h.get("delay")!=="false",[g,j]=i.useState(null),[r,p]=i.useState(null),[x,f]=i.useState(new Set),[m,c]=i.useState(null),[b,A]=i.useState({}),[N,k]=i.useState(new Set),[D,M]=i.useState({}),P=async()=>{const a=Math.floor(Math.random()*K)+1,t=Math.floor(Math.random()*W);try{if(S.get(a))console.log(`Returning cached quote ${a} ${t}`);else{const d=`https://glowing-invention-gv9qvjpvgg43w4q6-3000.app.github.dev/?page=${a}`;console.log(`Fetching quote ${t} from page ${a}`),S.set(a,new Promise(async(l,n)=>{const u=await fetch(d);if(!u.ok){console.log(`HTTP error ${u.status}: ${u.statusText}`),S.delete(a);const v="Problem retrieving quotes make sure the remote server is running and hit space again";return j(v),n(),{error:v}}const w=new Map;(await u.json()).forEach((v,R)=>{console.log(""),console.log(v),w.set(R,v)}),l(w)}))}const s=await S.get(a);return s==null?void 0:s.get(t)}catch(s){return console.error("** Fetch Failed:",s==null?void 0:s.message),{error:s==null?void 0:s.message}}},E=async a=>{const t=["Starting fetch...","Logging in...",`Browsing to page ${Math.floor(Math.random()*10)+1}...`,"Selecting random quote...","Selected."];k(s=>new Set([...s,a]));for(let s=0;s<t.length;s++){M(l=>({...l,[a]:t[s]}));const d=o?Math.floor(Math.random()*1201)+1200:0;await new Promise(l=>setTimeout(l,d))}try{const s=await P();console.log("::Quote::"),console.log(s),s&&console.log("text"in s),A(d=>({...d,[a]:s&&"text"in s?s:null})),k(d=>{const l=new Set(d);return l.delete(a),l}),M(d=>{const l={...d};return delete l[a],l})}catch(s){console.error("Random quote failure:",s==null?void 0:s.message)}};return i.useEffect(()=>{console.log("-- Rendeirng welcome component");const a=t=>{if(r===null){t.preventDefault(),p(0);return}const s=Math.floor(r/3),d=r%3,l=(n,u)=>{const w=new Set(x);w.add(u),f(w)};switch(t.key){case"ArrowUp":if(t.preventDefault(),s>0){const n=r-3;p(n),t.shiftKey?(m===null&&(c(r),f(new Set([r]))),l(m,n)):c(null)}break;case"ArrowDown":if(t.preventDefault(),s<99){const n=r+3;p(n),t.shiftKey?(m===null&&(c(r),f(new Set([r]))),l(m,n)):c(null)}break;case"ArrowLeft":if(t.preventDefault(),d>0){const n=r-1;p(n),t.shiftKey?(m===null&&(c(r),f(new Set([r]))),l(m,n)):c(null)}break;case"ArrowRight":if(t.preventDefault(),d<2){const n=r+1;p(n),t.shiftKey?(m===null&&(c(r),f(new Set([r]))),l(m,n)):c(null)}break;case"x":case"X":t.preventDefault(),f(n=>{const u=new Set(n);return u.has(r)?u.delete(r):u.add(r),u}),c(null);break;case" ":t.preventDefault(),x.size>0?x.forEach(n=>{N.has(n)||E(n)}):r!==null&&(N.has(r)||E(r));break;case"Escape":t.preventDefault(),f(new Set),c(null);break;case"a":case"A":if(t.ctrlKey||t.metaKey){t.preventDefault();const n=new Set(Array.from({length:300},(u,w)=>w));f(n),c(null)}break}};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[r,m,x,b,N]),e.jsxs("main",{className:"min-h-screen p-8 bg-background",children:[e.jsxs("div",{className:"mx-auto w-fit",children:[e.jsx("h1",{className:"text-3xl font-bold text-center mb-8 text-foreground",children:"Live Quote Scraper"}),e.jsxs("div",{className:"flex gap-8 items-start",children:[e.jsx(Q,{}),e.jsx("div",{className:"grid grid-cols-3 gap-2 flex-shrink-0",children:Array.from({length:300},(a,t)=>e.jsx(q,{index:t,isFocused:r===t,isSelected:x.has(t),isLoading:N.has(t),loadingMessage:D[t],content:b[t]},t))}),e.jsx(T,{cellContent:r===null?null:b[r]})]})]}),g&&e.jsx(F,{message:g,onClose:()=>j(null)})]})}function _({}){return[{title:"New React Router App"},{name:"description",content:"Welcome to React Router!"}]}const G=$(function(){return i.useEffect(()=>{console.log("-- Rendeirng home component")}),e.jsx(B,{})});export{G as default,_ as meta};
